<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Oyun.Hub - Dinamik Paddle & Efektler</title>
<style>
body {display:flex;flex-direction:column;align-items:center;min-height:100vh;margin:0;background-color:#f0f0f0;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;padding-bottom:50px;}
#gameCanvas {border:6px solid #333;box-shadow:0 0 30px rgba(0,0,0,0.5);background-color:#e0f7fa;margin-top:20px;margin-bottom:40px;
    max-width: 95vw; 
    height: auto;
}
h1 {color:#333;margin:20px 0;font-size:2.5em;}
#startButton {position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);padding:18px 35px;font-size:1.6em;background-color:#4CAF50;color:white;border:none;border-radius:8px;cursor:pointer;box-shadow:0 4px 6px rgba(0,0,0,0.2);transition:background-color 0.3s, transform 0.1s;z-index:10;opacity:0.9;}
#startButton:hover {background-color:#45a049;opacity:1;}
#startButton:active {transform:translate(-50%,-50%) scale(0.98);}
.game-container {position:relative;display:inline-block;}
.content-area {width:80%;max-width:900px;text-align:left;padding:20px;background-color:white;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,0.1);}
.content-area h2 {color:#007bff;border-bottom:2px solid #007bff;padding-bottom:5px;margin-top:30px;}
.content-area p,.content-area ul {color:#555;line-height:1.6;}
.footer {width:100%;background-color:#333;color:white;text-align:center;padding:15px 0;margin-top:50px;font-size:0.9em;}
.modal-overlay {position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.6);display:none;justify-content:center;align-items:center;z-index:1000;}
.modal-content {background-color:white;padding:30px;border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,0.3);text-align:center;width:300px;}
.modal-content h2 {margin-top:0;color:#D32F2F;}
.modal-content button {padding:10px 20px;background-color:#4CAF50;color:white;border:none;border-radius:5px;cursor:pointer;}
#congratsMessage {position:fixed;top:-50px;left:50%;transform:translateX(-50%);background-color:#FFC107;color:#333;padding:10px 20px;border-radius:5px;font-size:1.2em;font-weight:bold;box-shadow:0 4px 10px rgba(0,0,0,0.3);transition:top 0.5s ease-out,opacity 0.5s;z-index:2000;opacity:0;}
.visible-message {top:20px !important;opacity:1 !important;}
</style>
</head>
<body>

<h1>â­ Oyun.Hub â­</h1>
<div id="congratsMessage"></div>

<div class="game-container">
<button id="startButton" onclick="startGame()">Oyuna BaÅŸla (Space)</button>
<canvas id="gameCanvas" width="700" height="500"></canvas>
</div>

<div class="content-area">
<h2>ğŸš€ HakkÄ±mÄ±zda</h2>
<p><strong>Oyun.Hub</strong>, basit, hÄ±zlÄ± ve eÄŸlenceli tarayÄ±cÄ± oyunlarÄ±nÄ± tek bir merkezde toplar. Bu "Top ve Raket" oyunu ile reflekslerinizi test edin ve en yÃ¼ksek skoru yapmaya Ã§alÄ±ÅŸÄ±n.</p>
<h2>ğŸ›¡ï¸ Gizlilik PolitikasÄ±</h2>
<p>Oyun.Hub, kullanÄ±cÄ± gizliliÄŸine Ã¶nem verir. Sadece Local Storage ile en yÃ¼ksek skor saklanÄ±r.</p>
<h2>âœ‰ï¸ Ä°letiÅŸim</h2>
<p>E-posta: <strong>oyun.hub@gmail.com</strong></p>
</div>

<div class="footer">
Â© 2025 Oyun.Hub TÃ¼m HaklarÄ± SaklÄ±dÄ±r.
</div>

<div id="gameOverModal" class="modal-overlay">
<div class="modal-content">
<h2>OYUN BÄ°TTÄ°!</h2>
<p id="finalScoreText">Skorunuz: 0</p>
<button onclick="restartGame()">Tamam (Tekrar Oyna)</button>
</div>
</div>

<script>
const CONFIG = {
    BALL_RADIUS: 10,
    PADDLE_HEIGHT: 10,
    PADDLE_BOTTOM_MARGIN: 15,
    INITIAL_PADDLE_WIDTH: 120,
    MIN_PADDLE_WIDTH: 60,
    MAX_SPEED: 12, 
    INITIAL_DX: 4,
    INITIAL_DY: -4,
    PADDLE_SPEED: 7,
    SCORE_PER_HIT: 10,
    MAX_DELTA_FACTOR: 3,
    PADDLE_SMOOTHING_FACTOR: 0.2 // HatalÄ± hÄ±zlÄ± giriÅŸi yumuÅŸatÄ±r
};

var canvas = document.getElementById("gameCanvas");
var ctx = canvas.getContext("2d");
var startButton = document.getElementById("startButton");
var gameOverModal = document.getElementById("gameOverModal");
var finalScoreText = document.getElementById("finalScoreText");
var congratsMessage = document.getElementById("congratsMessage");

var x, y, dx, dy, paddleX, paddleWidth, score, nextTebrikScore, ballColorHue, timeLastFrame, animationFrameId; 
var rightPressed = false, leftPressed = false, gameStarted = false;
var highScore = localStorage.getItem('oyunhub_highScore') || 0;
var paddleY = canvas.height - CONFIG.PADDLE_HEIGHT - CONFIG.PADDLE_BOTTOM_MARGIN;
var activeEffect = null;
var effectTimeoutId = null;

var effectScoreMap = { 100: "stars", 300: "volcano", 500: "rain" };
var effectTriggered = {};

var hitSound = new Audio("https://freesound.org/data/previews/26/26102_49228-lq.mp3");
var gameOverSound = new Audio("https://freesound.org/data/previews/331/331912_3248244-lq.mp3");

var touchStartX = 0; 
var canvasRect = canvas.getBoundingClientRect(); 
var targetPaddleX; // Yeni: Raketin ulaÅŸmak istediÄŸi yumuÅŸatÄ±lmamÄ±ÅŸ konum

function updateCanvasDimensions() {
    canvasRect = canvas.getBoundingClientRect();
    paddleY = canvas.height - CONFIG.PADDLE_HEIGHT - CONFIG.PADDLE_BOTTOM_MARGIN;
}

window.addEventListener('resize', updateCanvasDimensions);
updateCanvasDimensions(); 

function init() {
    x = canvas.width / 2;
    y = paddleY - CONFIG.BALL_RADIUS;
    dx = CONFIG.INITIAL_DX;
    dy = CONFIG.INITIAL_DY;
    paddleWidth = CONFIG.INITIAL_PADDLE_WIDTH;
    paddleX = (canvas.width - paddleWidth) / 2;
    targetPaddleX = paddleX; // BaÅŸlangÄ±Ã§ta hedef ile mevcut konumu eÅŸitle
    score = 0;
    nextTebrikScore = 100;
    ballColorHue = 200;
    gameStarted = false;
    
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    gameOverModal.style.display = 'none';
    congratsMessage.classList.remove('visible-message');
    
    activeEffect = null;
    effectTriggered = {};
    if (effectTimeoutId) clearTimeout(effectTimeoutId);

    drawBall();
    drawPaddle();
    drawScoreAndHighScore();
}

function startGame() {
    if (gameStarted) return;
    startButton.style.display = 'none';
    
    x = canvas.width / 2;
    y = paddleY - CONFIG.BALL_RADIUS;
    dx = CONFIG.INITIAL_DX;
    dy = CONFIG.INITIAL_DY;

    gameStarted = true;
    
    hitSound.play().catch(() => {}); hitSound.pause(); hitSound.currentTime = 0;
    
    timeLastFrame = performance.now();
    gameLoop(timeLastFrame);
}

function gameOver() {
    if (!gameStarted) return; 
    gameStarted = false;
    cancelAnimationFrame(animationFrameId); 

    gameOverSound.play().catch(() => {});
    
    if (score > highScore) {
        highScore = score;
        localStorage.setItem('oyunhub_highScore', highScore);
    }
    
    drawScoreAndHighScore();
    finalScoreText.textContent = "Skorunuz: " + score;
    gameOverModal.style.display = 'flex';
}

function restartGame() {
    gameOverModal.style.display = 'none';
    startButton.style.display = 'block';
    init();
}

document.addEventListener("keydown", keyDownHandler, false);
document.addEventListener("keyup", keyUpHandler, false);
document.addEventListener("mousemove", mouseMoveHandler, false);

function keyDownHandler(e) {
    if (e.key === " " && !gameStarted) {
        e.preventDefault();
        startGame();
    }
    if (["Right", "ArrowRight", "d", "D"].includes(e.key)) rightPressed = true;
    if (["Left", "ArrowLeft", "a", "A"].includes(e.key)) leftPressed = true;
}
function keyUpHandler(e) {
    if (["Right", "ArrowRight", "d", "D"].includes(e.key)) rightPressed = false;
    if (["Left", "ArrowLeft", "a", "A"].includes(e.key)) leftPressed = false;
}
function mouseMoveHandler(e) {
    if (!gameStarted) return;
    
    var clientX = e.clientX;
    var relativeX = clientX - canvasRect.left; 

    var scaleFactor = canvas.width / canvasRect.width;
    var scaledX = relativeX * scaleFactor;

    if (scaledX > 0 && scaledX < canvas.width) {
        // Hedef konumu ayarla
        targetPaddleX = Math.max(0, Math.min(scaledX - paddleWidth / 2, canvas.width - paddleWidth));
    }
}

canvas.addEventListener('touchstart', e => {
    if (!gameStarted) startGame();
    if (e.touches.length > 1) {
        e.preventDefault(); 
        return;
    }
    e.preventDefault(); 
    updateCanvasDimensions(); 
    touchStartX = e.touches[0].clientX;
}, { passive: false });

canvas.addEventListener('touchmove', e => {
    if (!gameStarted) return;
    e.preventDefault(); 
    
    var clientX = e.touches[0].clientX;
    var relativeX = clientX - canvasRect.left; 
    
    var scaleFactor = canvas.width / canvasRect.width;
    var scaledX = relativeX * scaleFactor; 

    if (scaledX > 0 && scaledX < canvas.width) {
        // Hedef konumu ayarla
        targetPaddleX = Math.max(0, Math.min(scaledX - paddleWidth / 2, canvas.width - paddleWidth));
    }
}, { passive: false });

canvas.addEventListener('touchend', e => {
    rightPressed = false; 
    leftPressed = false;
}, { passive: false });


function drawBall() {
    ctx.beginPath();
    ctx.arc(x, y, CONFIG.BALL_RADIUS, 0, Math.PI * 2);
    ctx.fillStyle = `hsl(${ballColorHue}, 100%, 50%)`;
    ctx.fill();
    ctx.closePath();
}

function drawPaddle() {
    ctx.beginPath();
    ctx.rect(paddleX, paddleY, paddleWidth, CONFIG.PADDLE_HEIGHT);
    ctx.fillStyle = "#000";
    ctx.fill();
    ctx.closePath();
}

function drawScoreAndHighScore() {
    ctx.font = "16px Arial";
    ctx.fillStyle = "#000";
    ctx.fillText("Skor: " + score, 8, 20);
    
    var hsText = "En YÃ¼ksek Skor: " + highScore;
    ctx.fillText(hsText, canvas.width - ctx.measureText(hsText).width - 8, 20);
}

function showCongratsMessage(currentScore) {
    congratsMessage.textContent = `TEBRÄ°KLER! ${currentScore} PUANA ULAÅTINIZ!`;
    congratsMessage.classList.add('visible-message');
    setTimeout(() => {
        congratsMessage.classList.remove('visible-message');
    }, 3000);
}

function updatePaddleSize() {
    var min = CONFIG.MIN_PADDLE_WIDTH,
        max = CONFIG.INITIAL_PADDLE_WIDTH;
    var factor = (score % 150) / 150;
    paddleWidth = max - (max - min) * factor; 
    
    if (factor < 0.02) paddleWidth = max; 
}

function startEffect(type) {
    if (effectTimeoutId) clearTimeout(effectTimeoutId); 
    activeEffect = type;
    effectTriggered[type] = true;
    effectTimeoutId = null; 
}

function drawEffects() {
    if (!activeEffect) return;
    
    ctx.save(); 
    ctx.fillStyle = "rgba(0, 0, 0, 0.1)"; 
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    switch (activeEffect) {
        case "stars":
            for (var i = 0; i < 50; i++) {
                ctx.beginPath();
                ctx.arc(Math.random() * canvas.width, Math.random() * canvas.height, Math.random() * 2, 0, Math.PI * 2);
                ctx.fillStyle = "white";
                ctx.fill();
            }
            break;
        case "volcano":
            for (var i = 0; i < 20; i++) {
                ctx.beginPath();
                ctx.arc(Math.random() * canvas.width, canvas.height - Math.random() * 50, Math.random() * 10, 0, Math.PI * 2);
                ctx.fillStyle = "rgba(255, 165, 0, 0.8)"; 
                ctx.fill();
            }
            break;
        case "rain":
            for (var i = 0; i < 100; i++) {
                ctx.beginPath();
                var rx = Math.random() * canvas.width;
                var ry = Math.random() * canvas.height;
                ctx.moveTo(rx, ry);
                ctx.lineTo(rx + 2, ry + 10);
                ctx.strokeStyle = "rgba(0, 0, 255, 0.6)"; 
                ctx.lineWidth = 1;
                ctx.stroke();
            }
            break;
    }
    ctx.restore(); 
}

function checkPaddleCollision() {
    const nextY = y + CONFIG.BALL_RADIUS + dy;
    const ballBottom = y + CONFIG.BALL_RADIUS; 
    
    if (dy > 0 && ballBottom <= paddleY && nextY >= paddleY) {
        
        if (x > paddleX && x < paddleX + paddleWidth) {
            
            hitSound.currentTime = 0;
            hitSound.play().catch(() => {});
            
            score += CONFIG.SCORE_PER_HIT;
            ballColorHue = (ballColorHue + 10) % 360;
            updatePaddleSize();
            
            var intersectionX = x - paddleX; 
            var paddleCenter = paddleWidth / 2;
            var relativeIntersectX = intersectionX - paddleCenter; 
            var normalizedRelativeIntersectionX = relativeIntersectX / paddleCenter * 0.8; 
            
            dx = normalizedRelativeIntersectionX * (Math.abs(CONFIG.INITIAL_DX) * 2); 
            dy = -Math.abs(dy); 
            
            var speedIncrease = 1.02;
            dx *= speedIncrease;
            dy *= speedIncrease;
            
            var currentSpeed = Math.sqrt(dx * dx + dy * dy);
            if (currentSpeed > CONFIG.MAX_SPEED) {
                var scaleFactor = CONFIG.MAX_SPEED / currentSpeed;
                dx *= scaleFactor;
                dy *= scaleFactor;
            }
            
            if (score >= nextTebrikScore && nextTebrikScore <= 1000) {
                showCongratsMessage(nextTebrikScore);
                nextTebrikScore += 100;
            }

            y = paddleY - CONFIG.BALL_RADIUS;
        }
    }
}

function gameLoop(timeNow) {
    if (!gameStarted) return;

    var deltaTime = timeNow - timeLastFrame;
    timeLastFrame = timeNow;
    
    var factor = deltaTime / (1000 / 60); 
    factor = Math.min(factor, CONFIG.MAX_DELTA_FACTOR);

    // 1. Ã‡Ä°ZÄ°M TEMÄ°ZLÄ°ÄÄ° GARANTÄ°SÄ°
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    // ctx.fillStyle = 'rgba(0, 0, 0, 0)'; 
    // ctx.fillRect(0, 0, canvas.width, canvas.height); // (Tekrar temizlik performansÄ± dÃ¼ÅŸÃ¼rdÃ¼ÄŸÃ¼ iÃ§in sadece clearRect yeterli olmalÄ±)

    // 2. Paddle Hareket (YumuÅŸatma ve Klavye KontrolÃ¼)

    // Klavye kontrolÃ¼ varsa hedef X'i gÃ¼ncelle
    var paddleMovement = CONFIG.PADDLE_SPEED * factor;
    if (rightPressed) {
        targetPaddleX += paddleMovement;
    } else if (leftPressed) {
        targetPaddleX -= paddleMovement;
    }
    
    // Klavye veya dokunma ile belirlenen hedef X'i sÄ±nÄ±rla
    targetPaddleX = Math.max(0, Math.min(targetPaddleX, canvas.width - paddleWidth));
    
    // YUMUÅATMA: Mevcut konumu, hedefe doÄŸru yavaÅŸÃ§a hareket ettir
    var deltaX = targetPaddleX - paddleX;
    paddleX += deltaX * CONFIG.PADDLE_SMOOTHING_FACTOR;
    
    // 3. Top Hareketi
    x += dx * factor;
    y += dy * factor;

    if (x + dx * factor > canvas.width - CONFIG.BALL_RADIUS || x + dx * factor < CONFIG.BALL_RADIUS) {
        dx = -dx;
    }
    if (y + dy * factor < CONFIG.BALL_RADIUS) {
        dy = -dy;
    }

    checkPaddleCollision();

    if (y - CONFIG.BALL_RADIUS > canvas.height) {
        gameOver();
        return; 
    }
    
    for (var s in effectScoreMap) {
        if (score >= s && !effectTriggered[effectScoreMap[s]]) {
            startEffect(effectScoreMap[s]);
        }
    }

    drawBall();
    drawPaddle();
    drawScoreAndHighScore();
    drawEffects(); 

    animationFrameId = requestAnimationFrame(gameLoop);
}

init();
</script>
</body>
</html>
